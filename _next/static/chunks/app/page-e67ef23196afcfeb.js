(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{32383:()=>{},41057:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var a=t(95155),i=t(12115),n=t(3925),r=t(91540),o=t(83540),c=t(93774),l=t(94754),d=t(96025),h=t(16238),u=t(94517),p=t(24026),x=t(17398);function j(){let[e,s]=(0,i.useState)([]),[t,j]=(0,i.useState)(""),[m,f]=(0,i.useState)(""),[v,b]=(0,i.useState)(""),[N,O]=(0,i.useState)(""),[w,g]=(0,i.useState)(""),[y,q]=(0,i.useState)(1);(0,i.useEffect)(()=>{fetch("".concat("http://10.107.194.110/insp/","/api/dashboard/inspecciones/")).then(e=>e.json()).then(e=>s(e)).catch(console.error)},[]);let K=Array.from(new Set(e.filter(e=>(""===m||e.equipo===m)&&(""===v||e.fecha===v)&&(""===N||e.owner===N)).map(e=>e.zona))),E=Array.from(new Set(e.filter(e=>(""===t||e.zona===t)&&(""===v||e.fecha===v)&&(""===N||e.owner===N)).map(e=>e.equipo))),D=Array.from(new Set(e.filter(e=>(""===t||e.zona===t)&&(""===m||e.equipo===m)&&(""===N||e.owner===N)).map(e=>e.fecha))),F=Array.from(new Set(e.filter(e=>(""===t||e.zona===t)&&(""===m||e.equipo===m)&&(""===v||e.fecha===v)).map(e=>e.owner))),S=new Date,k=new Date;k.setDate(S.getDate()-7);let I=e.reduce((e,s)=>{let t=new Date("".concat(s.fecha,"T").concat(s.horaInicio));return(!e[s.equipo]||t>e[s.equipo])&&(e[s.equipo]=t),e},{}),z=e.filter(e=>{let s=""===w||("PENDIENTE"===w?I[e.equipo]<k:e.tecnicos.some(e=>e.estado===w));return(""===t||e.zona===t)&&(""===m||e.equipo===m)&&(""===v||e.fecha===v)&&(""===N||e.owner===N)&&s});z.sort((e,s)=>{let t=new Date("".concat(e.fecha,"T").concat(e.horaInicio)),a=new Date("".concat(s.fecha,"T").concat(s.horaInicio));return t.getTime()-a.getTime()}),Object.entries(z.reduce((e,s)=>(e[s.equipo]=(e[s.equipo]||0)+1,e),{})).map(e=>{let[s,t]=e;return{equipo:s,cantidad:t}});let C=Object.values(z.reduce((e,s)=>{var t;return e[s.equipo]||(e[s.equipo]={equipo:s.equipo,OK:0,NOK:0}),null==(t=s.tecnicos)||t.forEach(t=>{"OK"===t.estado&&(e[s.equipo].OK+=1),"NOK"===t.estado&&(e[s.equipo].NOK+=1)}),e},{})),T=C.reduce((e,s)=>e+s.OK,0),_=C.reduce((e,s)=>e+s.NOK,0),A=e=>{if(!e)return"";let s=e.split(":");return s.length>=2?"".concat(s[0],":").concat(s[1]):e},P=z.reduce((e,s)=>(e[s.zona]||(e[s.zona]=[]),e[s.zona].push(s),e),{});return(0,a.jsxs)("div",{className:"w-full max-w-7xl mx-auto mt-10 mb-14 px-4 text-center space-y-10",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-center gap-4 mb-6",children:[(0,a.jsxs)("select",{value:t,onChange:e=>j(e.target.value),className:"select-filtro",children:[(0,a.jsx)("option",{value:"",children:"Filtrar por Zona"}),K.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"select-filtro",children:[(0,a.jsx)("option",{value:"",children:"Filtrar por Equipo"}),E.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"select-filtro",children:[(0,a.jsx)("option",{value:"",children:"Filtrar por Fecha"}),D.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:N,onChange:e=>O(e.target.value),className:"select-filtro",children:[(0,a.jsx)("option",{value:"",children:"Filtrar por Owner"}),F.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:w,onChange:e=>g(e.target.value),className:"select-filtro",children:[(0,a.jsx)("option",{value:"",children:"Filtrar por Estado"}),(0,a.jsx)("option",{value:"OK",children:"OK"}),(0,a.jsx)("option",{value:"NOK",children:"NOK"}),(0,a.jsx)("option",{value:"PENDIENTE",children:"PENDIENTE"})]})]}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-6 mt-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>{j(""),f(""),b(""),O(""),g("")},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded shadow-md transition duration-200",children:"\uD83E\uDDF9 Limpiar Filtros"}),(0,a.jsx)("button",{onClick:()=>{let e=z.map(e=>({Fecha:e.fecha,"Hora Inicio":A(e.horaInicio),"Hora Fin":A(e.horaFin),División:e.division,Área:e.area,Zona:e.zona,Equipo:e.equipo,Owner:e.owner,Observaciones:e.observaciones,OK:e.tecnicos.filter(e=>"OK"===e.estado).length,NOK:e.tecnicos.filter(e=>"NOK"===e.estado).length,"No aplica":e.tecnicos.filter(e=>"No aplica"===e.estado).length})),s=n.Wp.json_to_sheet(e),t=n.Wp.book_new();n.Wp.book_append_sheet(t,s,"Inspecciones");let a=new Blob([n.M9(t,{bookType:"xlsx",type:"array"})],{type:"application/octet-stream"});(0,r.saveAs)(a,"inspecciones.xlsx")},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded shadow-md transition duration-200",children:"\uD83D\uDCE4 Exportar a Excel"})]}),(0,a.jsxs)("div",{className:"summary-cards justify-center",children:[(0,a.jsxs)("div",{className:"summary-card",children:["Total inspecciones: ",z.length]}),(0,a.jsxs)("div",{className:"summary-card",children:["Equipos distintos: ",E.length]}),(0,a.jsxs)("div",{className:"summary-card",children:["Respuestas OK: ",T]}),(0,a.jsxs)("div",{className:"summary-card",children:["Respuestas NOK: ",_]})]}),(0,a.jsx)("h2",{className:"section-title",children:"Inspecciones T\xe9cnicas"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Fecha"}),(0,a.jsx)("th",{children:"Hora Inicio"}),(0,a.jsx)("th",{children:"Hora Fin"}),(0,a.jsx)("th",{children:"Divisi\xf3n"}),(0,a.jsx)("th",{children:"\xc1rea"}),(0,a.jsx)("th",{children:"Zona"}),(0,a.jsx)("th",{children:"Equipo"}),(0,a.jsx)("th",{children:"Owner"}),(0,a.jsx)("th",{children:"Observaciones"})]})}),(0,a.jsx)("tbody",{children:z.slice((y-1)*30,30*y).map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.fecha}),(0,a.jsx)("td",{children:A(e.horaInicio)}),(0,a.jsx)("td",{children:A(e.horaFin)}),(0,a.jsx)("td",{children:e.division}),(0,a.jsx)("td",{children:e.area}),(0,a.jsx)("td",{children:e.zona}),(0,a.jsx)("td",{children:e.equipo}),(0,a.jsx)("td",{children:e.owner}),(0,a.jsx)("td",{className:"text-left",children:e.observaciones})]},e.id))})]})}),(0,a.jsxs)("div",{className:"flex justify-center gap-4 mt-6",children:[y>1&&(0,a.jsx)("button",{onClick:()=>q(y-1),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded shadow-md transition duration-200",children:"P\xe1gina Anterior"}),30*y<z.length&&(0,a.jsx)("button",{onClick:()=>q(y+1),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded shadow-md transition duration-200",children:"P\xe1gina Siguiente"})]}),Object.entries(P).map(e=>{let[s,t]=e,i=Object.entries(t.reduce((e,s)=>(e[s.equipo]=(e[s.equipo]||0)+1,e),{})).map(e=>{let[s,t]=e;return{equipo:s,cantidad:t}}),n=Object.values(t.reduce((e,s)=>(e[s.equipo]||(e[s.equipo]={equipo:s.equipo,OK:0,NOK:0}),s.tecnicos.forEach(t=>{"OK"===t.estado&&(e[s.equipo].OK+=1),"NOK"===t.estado&&(e[s.equipo].NOK+=1)}),e),{}));return(0,a.jsxs)("div",{className:"mb-16",children:[(0,a.jsxs)("h2",{className:"section-title",children:["Zona ",s," - Inspecciones por Equipo"]}),(0,a.jsx)("div",{style:{width:"100%",height:300},children:(0,a.jsx)(o.u,{children:(0,a.jsxs)(c.E,{data:i,barSize:50,children:[(0,a.jsx)(l.d,{strokeDasharray:"3 3"}),(0,a.jsx)(d.W,{dataKey:"equipo"}),(0,a.jsx)(h.h,{}),(0,a.jsx)(u.m,{}),(0,a.jsx)(p.s,{}),(0,a.jsx)(x.y,{dataKey:"cantidad",fill:"#003399"})]})})}),(0,a.jsxs)("h2",{className:"section-title",children:["Zona ",s," - Respuestas OK / NOK"]}),(0,a.jsx)("div",{style:{width:"100%",height:300},children:(0,a.jsx)(o.u,{children:(0,a.jsxs)(c.E,{data:n,barSize:50,children:[(0,a.jsx)(l.d,{strokeDasharray:"3 3"}),(0,a.jsx)(d.W,{dataKey:"equipo"}),(0,a.jsx)(h.h,{}),(0,a.jsx)(u.m,{}),(0,a.jsx)(p.s,{}),(0,a.jsx)(x.y,{dataKey:"OK",fill:"#28a745"}),(0,a.jsx)(x.y,{dataKey:"NOK",fill:"#dc3545"})]})})})]},s)})]})}},47727:(e,s,t)=>{Promise.resolve().then(t.bind(t,41057))},83686:()=>{}},e=>{var s=s=>e(e.s=s);e.O(0,[524,189,441,684,358],()=>s(47727)),_N_E=e.O()}]);